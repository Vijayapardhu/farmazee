{% extends 'base.html' %}
{% load static %}

{% block title %}Sign In - Farmazee{% endblock %}

{% block extra_css %}
<style>
  .auth-bg {
    min-height: 100vh;
    background: radial-gradient(1200px 600px at 10% 10%, rgba(40, 167, 69, .15), transparent),
                radial-gradient(1000px 500px at 90% 20%, rgba(32, 201, 151, .15), transparent),
                linear-gradient(135deg, #eef2ff 0%, #f8f9ff 100%);
    display: flex; align-items: center; padding: 3rem 0;
  }
  .auth-card {
    background: rgba(255,255,255,0.85);
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,0.45);
    box-shadow: 0 10px 30px rgba(16, 24, 40, 0.08), 0 1px 2px rgba(16, 24, 40, 0.06);
    backdrop-filter: saturate(150%) blur(8px);
    transition: transform .2s ease, box-shadow .2s ease;
  }
  .auth-card:hover { transform: translateY(-2px); box-shadow: 0 16px 40px rgba(16,24,40,0.12); }
  .auth-header {
    text-align: center; padding-bottom: .5rem;
  }
  .form-label { font-weight: 600; color: #2a2f45; }
  .form-control { border-radius: 10px; border-color: #e5e7eb; padding: .75rem .9rem; }
  .form-control:focus { border-color: #20c997; box-shadow: 0 0 0 .2rem rgba(32,201,151,.15); }
  .btn-auth {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    border: none; padding: 12px 30px; font-size: 1.05rem; font-weight: 600; border-radius: 50px;
    transition: all .2s ease;
  }
  .btn-auth:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(40, 167, 69, 0.3); }
  .password-toggle { position: absolute; right: 10px; top: 38px; border: 0; background: transparent; color: #6b7280; padding: .25rem .5rem; cursor: pointer; }
  .position-relative { position: relative; }
</style>
{% endblock %}

{% block content %}
<div class="auth-bg">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6 col-lg-5 col-xl-4">
        <div class="auth-card p-4 p-md-5">
          <div class="auth-header mb-4">
            <i class="fas fa-seedling fa-3x text-success mb-3"></i>
            <h2 class="mb-1">Welcome back</h2>
            <p class="text-muted mb-0">Sign in to your account</p>
          </div>

          <form method="post" novalidate>
            {% csrf_token %}

            {% if form.errors %}
            <div class="alert alert-danger" role="alert">
              <i class="fas fa-exclamation-triangle me-2"></i>
              Please check your credentials and try again.
            </div>
            {% endif %}

            <div class="mb-3">
              <label for="{{ form.login.id_for_label }}" class="form-label">
                <i class="fas fa-user me-2"></i>{{ form.login.label }}
              </label>
              {{ form.login }}
              {% if form.login.errors %}
                <div class="text-danger small mt-1">{{ form.login.errors.0 }}</div>
              {% endif %}
            </div>

            <div class="mb-3 position-relative">
              <label for="{{ form.password.id_for_label }}" class="form-label">
                <i class="fas fa-lock me-2"></i>{{ form.password.label }}
              </label>
              {{ form.password }}
              <button type="button" class="password-toggle" onclick="togglePassword('{{ form.password.id_for_label }}', this)" aria-label="Toggle password visibility">
                <i class="far fa-eye"></i>
              </button>
              {% if form.password.errors %}
                <div class="text-danger small mt-1">{{ form.password.errors.0 }}</div>
              {% endif %}
            </div>

            <div class="mb-3 form-check">
              {{ form.remember }}
              <label class="form-check-label" for="{{ form.remember.id_for_label }}">
                {{ form.remember.label }}
              </label>
            </div>

            <div class="d-grid">
              <button type="submit" class="btn btn-auth btn-lg">
                <i class="fas fa-sign-in-alt me-2"></i>Sign In
              </button>
            </div>
          </form>

          <div class="text-center mt-4">
            <a href="{% url 'account_reset_password' %}" class="text-decoration-none">
              <i class="fas fa-key me-1"></i>Forgot your password?
            </a>
          </div>

          <div class="text-center mt-3">
            <p class="mb-0">Don't have an account? 
              <a href="{% url 'signup' %}" class="text-success fw-bold">Create one now</a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  function togglePassword(inputId, btn) {
    const input = document.getElementById(inputId);
    if (!input) return;
    const isText = input.getAttribute('type') === 'text';
    input.setAttribute('type', isText ? 'password' : 'text');
    btn.querySelector('i').className = isText ? 'far fa-eye' : 'far fa-eye-slash';
  }
</script>
{% endblock %}
